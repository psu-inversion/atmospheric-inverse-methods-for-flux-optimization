
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>inversion.optimal_interpolation module &#8212; Inversions 0.4.0.dev0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"extensions": ["tex2jax.js"], "jax": ["input/TeX", "output/HTML-CSS"], "TeX": {"extensions": ["AMSmath.js"]}})</script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="inversion.variational module" href="inversion.variational.html" />
    <link rel="prev" title="inversion.covariances module" href="inversion.covariances.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="inversion.variational.html" title="inversion.variational module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="inversion.covariances.html" title="inversion.covariances module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Inversions 0.4.0.dev0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="inversion.html" accesskey="U">inversion package</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-inversion.optimal_interpolation">
<span id="inversion-optimal-interpolation-module"></span><h1>inversion.optimal_interpolation module<a class="headerlink" href="#module-inversion.optimal_interpolation" title="Permalink to this headline">¶</a></h1>
<p>Inversions using Optimal Interpolaiton.</p>
<p>Also known as Kalman Matrix Inversion or batch inversion.</p>
<dl class="function">
<dt id="inversion.optimal_interpolation.fold_common">
<code class="descclassname">inversion.optimal_interpolation.</code><code class="descname">fold_common</code><span class="sig-paren">(</span><em>background</em>, <em>background_covariance</em>, <em>observations</em>, <em>observation_covariance</em>, <em>observation_operator</em>, <em>reduced_background_covariance</em>, <em>reduced_observation_operator</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/inversion/optimal_interpolation.html#fold_common"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#inversion.optimal_interpolation.fold_common" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the inversion problem, evaluating sub-expressions only once.</p>
<p>Assumes all arrays fit in memory with room to spare.</p>
<p>Assumes everything follows a multivariate normal distribution
with the specified covariance matrices.  Under this assumption
<cite>analysis_covariance</cite> is exact, and <cite>analysis</cite> is the Maximum
Likelihood Estimator and the Best Linear Unbiased Estimator
for the underlying state in the frequentist framework, and
specify the posterior distribution for the state in the
Bayesian framework.  If these are not satisfied, these still
form the Generalized Least Squares estimates for the state and
an estimated uncertainty.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>background</strong> (<em>array_like</em><em>[</em><em>N</em><em>]</em>) – The background state estimate.</li>
<li><strong>background_covariance</strong> (<em>array_like</em><em>[</em><em>N</em><em>, </em><em>N</em><em>]</em>) – Covariance of background state estimate across
realizations/ensemble members.  “Ensemble” is here
interpreted in the sense used in statistical mechanics or
frequentist statistics, and may not be derived from a
sample as in meteorological ensemble Kalman filters</li>
<li><strong>observations</strong> (<em>array_like</em><em>[</em><em>M</em><em>]</em>) – The observations constraining the background estimate.</li>
<li><strong>observation_covariance</strong> (<em>array_like</em><em>[</em><em>M</em><em>, </em><em>M</em><em>]</em>) – Covariance of observations across realizations/ensemble
members.  “Ensemble” again has the statistical meaning.</li>
<li><strong>observation_operator</strong> (<em>array_like</em><em>[</em><em>M</em><em>, </em><em>N</em><em>]</em>) – The relationship between the state and the observations.</li>
<li><strong>reduced_background_covariance</strong> (<em>array_like</em><em>[</em><em>Nred</em><em>, </em><em>Nred</em><em>]</em><em>, </em><em>optional</em>) – The covariance for a smaller state space, usually obtained by
reducing resolution in space and time.  Note that
<cite>reduced_observation_operator</cite> must also be provided</li>
<li><strong>reduced_observation_operator</strong> (<em>array_like</em><em>[</em><em>M</em><em>, </em><em>Nred</em><em>]</em><em>, </em><em>optional</em>) – The relationship between the reduced state space and the
observations.  Note that <cite>reduced_background_covariance</cite>
must also be provided.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>analysis</strong> (<em>array_like[N]</em>) – Analysis state estimate</li>
<li><strong>analysis_covariance</strong> (<em>array_like[Nred, Nred] or array_like[N, N]</em>) – Estimated uncertainty of analysis across
realizations/ensemble members.  Calculated using
reduced_background_covariance and
reduced_observation_operator if possible</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="inversion.optimal_interpolation.save_sum">
<code class="descclassname">inversion.optimal_interpolation.</code><code class="descname">save_sum</code><span class="sig-paren">(</span><em>background</em>, <em>background_covariance</em>, <em>observations</em>, <em>observation_covariance</em>, <em>observation_operator</em>, <em>reduced_background_covariance=None</em>, <em>reduced_observation_operator=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/inversion/optimal_interpolation.html#save_sum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#inversion.optimal_interpolation.save_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the inversion problem, evaluating sub-expressions only once.</p>
<p>Assumes all arrays fit in memory with room to spare.</p>
<p>Assumes everything follows a multivariate normal distribution
with the specified covariance matrices.  Under this assumption
<cite>analysis_covariance</cite> is exact, and <cite>analysis</cite> is the Maximum
Likelihood Estimator and the Best Linear Unbiased Estimator
for the underlying state in the frequentist framework, and
specify the posterior distribution for the state in the
Bayesian framework.  If these are not satisfied, these still
form the Generalized Least Squares estimates for the state and
an estimated uncertainty.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>background</strong> (<em>array_like</em><em>[</em><em>N</em><em>]</em>) – The background state estimate.</li>
<li><strong>background_covariance</strong> (<em>array_like</em><em>[</em><em>N</em><em>, </em><em>N</em><em>]</em>) – Covariance of background state estimate across
realizations/ensemble members.  “Ensemble” is here
interpreted in the sense used in statistical mechanics or
frequentist statistics, and may not be derived from a
sample as in meteorological ensemble Kalman filters</li>
<li><strong>observations</strong> (<em>array_like</em><em>[</em><em>M</em><em>]</em>) – The observations constraining the background estimate.</li>
<li><strong>observation_covariance</strong> (<em>array_like</em><em>[</em><em>M</em><em>, </em><em>M</em><em>]</em>) – Covariance of observations across realizations/ensemble
members.  “Ensemble” again has the statistical meaning.</li>
<li><strong>observation_operator</strong> (<em>array_like</em><em>[</em><em>M</em><em>, </em><em>N</em><em>]</em>) – The relationship between the state and the observations.</li>
<li><strong>reduced_background_covariance</strong> (<em>array_like</em><em>[</em><em>Nred</em><em>, </em><em>Nred</em><em>]</em><em>, </em><em>optional</em>) – The covariance for a smaller state space, usually obtained by
reducing resolution in space and time.  Note that
<cite>reduced_observation_operator</cite> must also be provided</li>
<li><strong>reduced_observation_operator</strong> (<em>array_like</em><em>[</em><em>M</em><em>, </em><em>Nred</em><em>]</em><em>, </em><em>optional</em>) – The relationship between the reduced state space and the
observations.  Note that <cite>reduced_background_covariance</cite>
must also be provided.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>analysis</strong> (<em>array_like[N]</em>) – Analysis state estimate</li>
<li><strong>analysis_covariance</strong> (<em>array_like[Nred, Nred] or array_like[N, N]</em>) – Estimated uncertainty of analysis across
realizations/ensemble members.  Calculated using
reduced_background_covariance and
reduced_observation_operator if possible</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="inversion.optimal_interpolation.scipy_chol">
<code class="descclassname">inversion.optimal_interpolation.</code><code class="descname">scipy_chol</code><span class="sig-paren">(</span><em>background</em>, <em>background_covariance</em>, <em>observations</em>, <em>observation_covariance</em>, <em>observation_operator</em>, <em>reduced_background_covariance=None</em>, <em>reduced_observation_operator=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/inversion/optimal_interpolation.html#scipy_chol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#inversion.optimal_interpolation.scipy_chol" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the Cholesky decomposition to solve the inverison problem.</p>
<p>Assumes all arrays fit in memory with room to spare.
Uses cholesky decomposition for solving a matrix equation
rather than using matrix inverses.</p>
<p>Assumes everything follows a multivariate normal distribution
with the specified covariance matrices.  Under this assumption
<cite>analysis_covariance</cite> is exact, and <cite>analysis</cite> is the Maximum
Likelihood Estimator and the Best Linear Unbiased Estimator
for the underlying state in the frequentist framework, and
specify the posterior distribution for the state in the
Bayesian framework.  If these are not satisfied, these still
form the Generalized Least Squares estimates for the state and
an estimated uncertainty.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>background</strong> (<em>array_like</em><em>[</em><em>N</em><em>]</em>) – The background state estimate.</li>
<li><strong>background_covariance</strong> (<em>array_like</em><em>[</em><em>N</em><em>, </em><em>N</em><em>]</em>) – Covariance of background state estimate across
realizations/ensemble members.  “Ensemble” is here
interpreted in the sense used in statistical mechanics or
frequentist statistics, and may not be derived from a
sample as in meteorological ensemble Kalman filters</li>
<li><strong>observations</strong> (<em>array_like</em><em>[</em><em>M</em><em>]</em>) – The observations constraining the background estimate.</li>
<li><strong>observation_covariance</strong> (<em>array_like</em><em>[</em><em>M</em><em>, </em><em>M</em><em>]</em>) – Covariance of observations across realizations/ensemble
members.  “Ensemble” again has the statistical meaning.</li>
<li><strong>observation_operator</strong> (<em>array_like</em><em>[</em><em>M</em><em>, </em><em>N</em><em>]</em>) – The relationship between the state and the observations.</li>
<li><strong>reduced_background_covariance</strong> (<em>array_like</em><em>[</em><em>Nred</em><em>, </em><em>Nred</em><em>]</em><em>, </em><em>optional</em>) – The covariance for a smaller state space, usually obtained by
reducing resolution in space and time.  Note that
<cite>reduced_observation_operator</cite> must also be provided</li>
<li><strong>reduced_observation_operator</strong> (<em>array_like</em><em>[</em><em>M</em><em>, </em><em>Nred</em><em>]</em><em>, </em><em>optional</em>) – The relationship between the reduced state space and the
observations.  Note that <cite>reduced_background_covariance</cite>
must also be provided.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>analysis</strong> (<em>array_like[N]</em>) – Analysis state estimate</li>
<li><strong>analysis_covariance</strong> (<em>array_like[Nred, Nred] or array_like[N, N]</em>) – Estimated uncertainty of analysis across
realizations/ensemble members.  Calculated using
reduced_background_covariance and
reduced_observation_operator if possible</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="inversion.optimal_interpolation.simple">
<code class="descclassname">inversion.optimal_interpolation.</code><code class="descname">simple</code><span class="sig-paren">(</span><em>background</em>, <em>background_covariance</em>, <em>observations</em>, <em>observation_covariance</em>, <em>observation_operator</em>, <em>reduced_background_covariance</em>, <em>reduced_observation_operator</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/inversion/optimal_interpolation.html#simple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#inversion.optimal_interpolation.simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the inversion problem using the equations literally.</p>
<p>Assumes all arrays fit in memory with room to spare.  A direct
translation of the matrix inversion equations to Python.</p>
<p>Assumes everything follows a multivariate normal distribution
with the specified covariance matrices.  Under this assumption
<cite>analysis_covariance</cite> is exact, and <cite>analysis</cite> is the Maximum
Likelihood Estimator and the Best Linear Unbiased Estimator
for the underlying state in the frequentist framework, and
specify the posterior distribution for the state in the
Bayesian framework.  If these are not satisfied, these still
form the Generalized Least Squares estimates for the state and
an estimated uncertainty.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>background</strong> (<em>array_like</em><em>[</em><em>N</em><em>]</em>) – The background state estimate.</li>
<li><strong>background_covariance</strong> (<em>array_like</em><em>[</em><em>N</em><em>, </em><em>N</em><em>]</em>) – Covariance of background state estimate across
realizations/ensemble members.  “Ensemble” is here
interpreted in the sense used in statistical mechanics or
frequentist statistics, and may not be derived from a
sample as in meteorological ensemble Kalman filters</li>
<li><strong>observations</strong> (<em>array_like</em><em>[</em><em>M</em><em>]</em>) – The observations constraining the background estimate.</li>
<li><strong>observation_covariance</strong> (<em>array_like</em><em>[</em><em>M</em><em>, </em><em>M</em><em>]</em>) – Covariance of observations across realizations/ensemble
members.  “Ensemble” again has the statistical meaning.</li>
<li><strong>observation_operator</strong> (<em>array_like</em><em>[</em><em>M</em><em>, </em><em>N</em><em>]</em>) – The relationship between the state and the observations.</li>
<li><strong>reduced_background_covariance</strong> (<em>array_like</em><em>[</em><em>Nred</em><em>, </em><em>Nred</em><em>]</em><em>, </em><em>optional</em>) – The covariance for a smaller state space, usually obtained by
reducing resolution in space and time.  Note that
<cite>reduced_observation_operator</cite> must also be provided</li>
<li><strong>reduced_observation_operator</strong> (<em>array_like</em><em>[</em><em>M</em><em>, </em><em>Nred</em><em>]</em><em>, </em><em>optional</em>) – The relationship between the reduced state space and the
observations.  Note that <cite>reduced_background_covariance</cite>
must also be provided.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>analysis</strong> (<em>array_like[N]</em>) – Analysis state estimate</li>
<li><strong>analysis_covariance</strong> (<em>array_like[Nred, Nred] or array_like[N, N]</em>) – Estimated uncertainty of analysis across
realizations/ensemble members.  Calculated using
reduced_background_covariance and
reduced_observation_operator if provided</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="inversion.covariances.html"
                        title="previous chapter">inversion.covariances module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="inversion.variational.html"
                        title="next chapter">inversion.variational module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/inversion.optimal_interpolation.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="inversion.variational.html" title="inversion.variational module"
             >next</a> |</li>
        <li class="right" >
          <a href="inversion.covariances.html" title="inversion.covariances module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Inversions 0.4.0.dev0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="inversion.html" >inversion package</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Daniel Wesloh.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>